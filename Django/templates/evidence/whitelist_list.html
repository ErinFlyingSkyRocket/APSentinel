{% extends "base.html" %}
{% block content %}
  <div class="whitelist-header" style="display:flex; align-items:center; justify-content:space-between; gap:1rem;">
    <h2>Whitelist</h2>
    <div class="actions">
      <a class="btn" href="{% url 'whitelist_add' %}">Add group</a>
    </div>
  </div>

  {% if groups %}
    <div class="table-wrap">
      <table class="whitelist">
        <thead>
          <tr>
            <th style="width:50px;">ID</th>
            <th>Group / SSID</th>
            <th>Location</th>
            <th>Default Security</th>
            <th>Strict</th>
            <th>Status</th>
            <th>Entries (BSSID / sec / ch)</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          {% for g in groups %}
            <tr>
              <td>{{ g.id }}</td>
              <td>
                <strong>{{ g.name }}</strong><br>
                <span class="muted">{{ g.ssid }}</span>
              </td>
              <td>{{ g.location|default:"—" }}</td>
              <td>{{ g.default_security|default:"—" }}</td>
              <td>
                {% if g.strict %}
                  <span class="badge-active">Yes</span>
                {% else %}
                  <span class="badge-inactive">No</span>
                {% endif %}
              </td>
              <td>
                {% if g.is_active %}
                  <span class="badge-active">Active</span>
                {% else %}
                  <span class="badge-inactive">Inactive</span>
                {% endif %}
              </td>
              <td>
                {% if g.entries.all %}
                  <ul style="margin:0; padding-left:1.2rem;">
                    {% for e in g.entries.all %}
                      <li>
                        <span class="mono">{{ e.bssid|default:"ANY" }}</span>
                        {% if e.security %} · {{ e.security }}{% endif %}
                        {% if e.channel %} · ch {{ e.channel }}{% endif %}
                        {% if not e.is_active %} · <span class="muted">inactive</span>{% endif %}
                      </li>
                    {% endfor %}
                  </ul>
                {% else %}
                  <span class="muted">No entries</span>
                {% endif %}
              </td>
              <td style="text-align:right; white-space:nowrap;">
                <a href="{% url 'whitelist_edit' g.id %}">Edit</a>
                <form action="{% url 'whitelist_delete' g.id %}" method="post" style="display:inline" onsubmit="return confirm('Delete this whitelist group and its entries?');">
                  {% csrf_token %}
                  <button class="btn-link" type="submit">Delete</button>
                </form>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  {% else %}
    <p class="empty">No whitelist groups yet.</p>
  {% endif %}
{% endblock %}
