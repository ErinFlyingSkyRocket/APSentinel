{% extends "base.html" %}
{% block content %}
  <div class="whitelist-header">
    <h2>Whitelist</h2>
    <div class="actions">
      <a class="btn" href="/ui/whitelist/add">Add</a>
    </div>
  </div>

  <form method="get" class="filterbar" style="grid-template-columns: 1.2fr 0.8fr auto;">
    <div class="field">
      <label>Search SSID</label>
      <input type="text" name="q" value="{{ q|default:'' }}" placeholder="e.g. Hospital-WiFi">
    </div>
    <div class="field">
      <label>Status</label>
      <select name="active">
        <option value="">Any</option>
        <option value="1" {% if active == '1' %}selected{% endif %}>Active</option>
        <option value="0" {% if active == '0' %}selected{% endif %}>Inactive</option>
      </select>
    </div>
    <div class="field">
      <label>&nbsp;</label>
      <button type="submit">Filter</button>
    </div>
  </form>

  <div class="table-wrap">
    <table class="whitelist">
      <thead>
        <tr>
          <th>ID</th>
          <th>SSID</th>
          <th>BSSID</th>
          <th>Security</th>
          <th>Status</th>
          <th>Updated</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for w in page.object_list %}
        <tr>
          <td>{{ w.id }}</td>
          <td>{{ w.ssid }}</td>
          <td class="mono"><span class="pill">{{ w.bssid|default:"—" }}</span></td>
          <td>{{ w.expected_security|default:"—" }}</td>
          <td>
            {% if w.active %}
              <span class="badge-active">Active</span>
            {% else %}
              <span class="badge-inactive">Inactive</span>
            {% endif %}
          </td>
          <td>{{ w.updated_at|date:"M j, Y, g:i a" }}</td>
          <td style="text-align:right; white-space:nowrap;">
            <a href="/ui/whitelist/{{ w.id }}/edit">Edit</a>
            <form action="/ui/whitelist/{{ w.id }}/delete" method="post" style="display:inline" onsubmit="return confirm('Delete this entry?');">
              {% csrf_token %}
              <button class="btn-link" type="submit">Delete</button>
            </form>
          </td>
        </tr>
        {% empty %}
        <tr><td colspan="7" class="empty">No whitelist entries yet.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="pager">
    {% if page.has_previous %}<a href="?page={{ page.previous_page_number }}&q={{ q }}&active={{ active }}">Prev</a>{% endif %}
    <span>Page {{ page.number }} / {{ page.paginator.num_pages }}</span>
    {% if page.has_next %}<a href="?page={{ page.next_page_number }}&q={{ q }}&active={{ active }}">Next</a>{% endif %}
  </div>
{% endblock %}
